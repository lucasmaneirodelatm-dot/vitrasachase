// datos.js
// ================================
//  HOJAS DE RUTA Y HORARIOS FIJOS
// ================================

// HORA VIRTUAL: los HTML la irán incrementando automáticamente
let reloj = 0; // en minutos virtuales desde el inicio

// BUSES DEFINIDOS
const BUSES = {
  "BUS6154": {
    id: "BUS154",
    linea: "C3.I",
    ruta: ["14123", "6650", "8410", "8430", "7410", "6450", "2830", "8390", "14165", "8340", "14892", "6990", "8460", "8480", "8450", "8470", "14173", "1150", "20194", "14333", "14121", "20198", "5530", "5540", "5560", "5580", "14396", "5500", "8030", "8010", "8050", "14132", "14130", "1680", "1610", "14134", "1640", "1650", "1660", "1790", "1760", "1730", "1750", "1720", "1820", "1830", "2090", "2130", "2110", "2060", "195", "250", "220", "260", "20054", "240", "8570", "8560", "8540", "8520", "8500", "8600", "8590", "8630", "6570", "6580", "5680", "5700", "14398", "5620", "5640", "6940", "1250", "20077", "1270", "1290", "20027", "1300", "8410", "8430", "2830", "8370", "6460", "14124", "7410", "6640", "14125", "14123"],
    frecuencia: 16,
    inicio: 50
  },
  "BUS6155": {
    id: "BUS155",
    linea: "C3.I",
    ruta: ["14123", "6650", "8410", "8430", "7410", "6450", "2830", "8390", "14165", "8340", "14892", "6990", "8460", "8480", "8450", "8470", "14173", "1150", "20194", "14333", "14121", "20198", "5530", "5540", "5560", "5580", "14396", "5500", "8030", "8010", "8050", "14132", "14130", "1680", "1610", "14134", "1640", "1650", "1660", "1790", "1760", "1730", "1750", "1720", "1820", "1830", "2090", "2130", "2110", "2060", "195", "250", "220", "260", "20054", "240", "8570", "8560", "8540", "8520", "8500", "8600", "8590", "8630", "6570", "6580", "5680", "5700", "14398", "5620", "5640", "6940", "1250", "20077", "1270", "1290", "20027", "1300", "8410", "8430", "2830", "8370", "6460", "14124", "7410", "6640", "14125", "14123"],
    frecuencia: 16,
    inicio: 15
  },
  "BUS6156": {
    id: "BUS156",
    linea: "N4",
    ruta: ["null"],
    frecuencia: 0,
    inicio: 0
  },
  "BUS6157": {
    id: "BUS157",
    linea: "C3.D",
    ruta: ["14123", "6650", "1320", "1310", "20075", "1880", "20076", "7410", "6450", "8440", "14131", "6180", "8950", "5070", "8930", "5090", "1260", "14901", "14206", "5650", "5630", "5690", "5600", "6550", "20177", "6560", "8610", "8580", "8620", "8510", "8530", "14126", "8490", "8550", "230", "190", "20053", "200", "210", "2100", "2070", "2080", "5030", "1710", "1840", "1740", "1770", "1780", "1800", "1810", "20132", "1670", "1590", "1630", "1620", "1600", "1690", "14133", "8040", "8020", "8060", "5490", "14397", "5510", "5570", "14245", "5520", "20193", "6860", "20195", "6300", "14223", "14224", "14225", "14226", "14227", "6980", "8330", "14164", "8370", "6460", "14124", "7410", "20100", "20099", "14131", "8440", "8420", "6640", "14125", "14123"],
    frecuencia: 16,
    inicio: 50
  },
  "BUS6158": {
    id: "BUS158",
    linea: "C3.D",
    ruta: ["14123", "6650", "1320", "1310", "20075", "1880", "20076", "7410", "6450", "8440", "14131", "6180", "8950", "5070", "8930", "5090", "1260", "14901", "14206", "5650", "5630", "5690", "5600", "6550", "20177", "6560", "8610", "8580", "8620", "8510", "8530", "14126", "8490", "8550", "230", "190", "20053", "200", "210", "2100", "2070", "2080", "5030", "1710", "1840", "1740", "1770", "1780", "1800", "1810", "20132", "1670", "1590", "1630", "1620", "1600", "1690", "14133", "8040", "8020", "8060", "5490", "14397", "5510", "5570", "14245", "5520", "20193", "6860", "20195", "6300", "14223", "14224", "14225", "14226", "14227", "6980", "8330", "14164", "8370", "6460", "14124", "7410", "20100", "20099", "14131", "8440", "8420", "6640", "14125", "14123"],
    frecuencia: 16,
    inicio: 15
  },
  "BUS6159": {
    id: "BUS159",
    linea: "Null",
    ruta: ["null"],
    frecuencia: 0,
    inicio: 0
  },
  "BUS6200": {
    id: "BUS200",
    linea: "24",
    ruta: ["20057", "430", "6860", "14121", "20198", "6620", "14264", "8820", "8840", "7000", "8610", "5810", "5820", "710", "910", "2930", "2870", "2880", "2910", "6740", "14385", "14386", "14387", "2920", "840", "5800", "5830", "20022", "20023", "8750", "8770", "5540", "20091", "20057"], // paradas en orden
    frecuencia: 10, // minutos
    inicio: 0 // empieza a las 00:00 virtuales
  },
  "BUS6201": {
    id: "BUS201",
    linea: "L16",
    ruta: ["20057", "20058", "14245", "5520", "20192", "14264", "8820", "5610", "8900", "8890", "6960", "14142", "14143", "14144", "14255", "14307", "14169", "5410", "5430", "5450", "5470", "7030", "6380", "6390", "14174", "20089", "14175", "6370", "6360", "5060", "20010", "20011", "20012", "1410", "1330", "2780", "14256", "14257", "14258", "14259", "14261", "6950", "20203", "5660", "8770", "5540", "5560", "20091", "20057"],
    frecuencia: 7,
    inicio: 27
  },
  "BUS6202": {
    id: "BUS202",
    linea: "L25",
    ruta: ["6550", "20177", "6560", "8610", "5810", "5820", "6210", "14140", "14376", "8140", "8160", "14416", "8170", "20050", "14190", "14220", "14191", "14204", "20059", "6010", "7310", "5260", "5180", "5190", "5200", "5220", "20191", "5230", "14192", "950", "690", "14193", "14194", "14201", "14195", "14196", "14378", "14197", "14198", "5170", "5280", "5270", "5250", "7340", "6040", "20060", "6020", "14199", "14221", "14200", "20051", "7860", "8130", "8120", "8150", "14337", "14139", "6200", "5800", "5830", "8630", "6570", "6580", "6955"],
    frecuencia: 8,
    inicio: 12
  },
  "BUS6203": {
    id: "BUS203",
    linea: "Null",
    ruta: ["null"],
    frecuencia: 0,
    inicio: 0
  },
  "BUS6204": {
    id: "BUS204",
    linea: "Null",
    ruta: ["null"],
    frecuencia: 0,
    inicio: 0
  },
  "BUS6205": {
    id: "BUS205",
    linea: "L10",
    ruta: ["7870", "2340", "2350", "2370", "2310", "650", "600", "3090", "310", "280", "320", "330", "270", "290", "3780", "3770", "3740", "3810", "3790", "14362", "2190", "2180", "2170", "2140", "2160", "14171", "2150", "990", "1000", "980", "1050", "14268", "1030", "14131", "8440", "8420", "1320", "1310", "20075", "1280", "20076", "1260", "14901", "3250", "6970", "3270", "1210", "1200", "20062", "1150", "14333", "20194", "14121", "20198", "5530", "5540", "5560", "5580", "14396", "5500", "8010", "8030", "8050", "14132", "1240", "1220", "230", "20053", "190", "200", "210", "14107", "14107!", "195", "250", "220", "260", "20054", "240", "1230", "14127", "8040", "8020", "8060", "5490", "14397", "5510", "5570", "14245", "5520", "20193", "6860", "14195", "6300", "14223", "14224", "14225", "14226", "14127", "20215", "3240", "6940", "1250", "20077", "1270", "1290", "20027", "1300", "8410", "8440", "1040", "14267", "1060", "1070", "1010", "1020", "6750", "4170", "6790", "6780", "6810", "6820", "6760", "3800", "6830", "3760", "3750", "310", "280", "320", "330", "270", "20212", "560", "2330", "2320", "2380", "2360", "7870"],
    frecuencia: 13,
    inicio: 3
  },
  "BUS6210": {
    id: "BUS210",
    linea: "L11",", 
    ruta: ["00"],
    frecuencia: 12,
    inicio: 3
  },
  "BUS6225": {
    id: "BUS225",
    linea: "c3",
    ruta: ["00"],
    frecuencia: 12,
    inicio: 3
  },
  "BUS6235": {
    id: "BUS235",
    linea: "L15a",
    ruta: ["00"],
    frecuencia: 12,
    inicio: 3
  },
  "BUS6800": {
    id: "BUS800",
    linea: "L4A",
    ruta: ["00"],
    frecuencia: 12,
    inicio: 3
  },
  "BUS6823": {
    id: "BUS823",
    linea: "L12B",
    ruta: ["00"],
    frecuencia: 12,
    inicio: 3
  },
  "BUS6950": {
    id: "BUS950",
    linea: "C1",
    ruta: ["6930", "3250", "6970", "14892", "8460", "8480", "8450", "8470", "14173", "1150", "14333", "20194", "14121", "20198", "6620", "14264", "8820", "5610", "5670", "14135", "2440", "2450", "2430", "14475", "6530", "14169", "6930"],
    frecuencia: 10,
    inicio: 10
  },
   "BUS6952": {
    id: "BUS952",
    linea: "C1",
    ruta: ["6930", "3250", "6970", "14892", "8460", "8480", "8450", "8470", "14173", "1150", "14333", "20194", "14121", "20198", "6620", "14264", "8820", "5610", "5670", "14135", "2440", "2450", "2430", "14475", "6530", "14169", "6930"],
    frecuencia: 10,
    inicio: 7
  },
   "BUS6954": {
    id: "BUS954",
    linea: "C1",
    ruta: ["6930", "3250", "6970", "14892", "8460", "8480", "8450", "8470", "14173", "1150", "14333", "20194", "14121", "20198", "6620", "14264", "8820", "5610", "5670", "14135", "2440", "2450", "2430", "14475", "6530", "14169", "6930"],
    frecuencia: 10,
    inicio: 4
  }
};

// ========================================
// CÁLCULO DE EN QUÉ PARADA ESTÁ UN BUS
// ========================================
function paradaActual(bus, minuto){
  const ciclo = Math.floor((minuto - bus.inicio) / bus.frecuencia);
  if (ciclo < 0) return null;
  const pos = ciclo % bus.ruta.length;
  return bus.ruta[pos];
}

// ========================================
// TIEMPO QUE FALTA PARA QUE UN BUS PASE
// ========================================
function eta(bus, paradaId, minuto){
  const idx = bus.ruta.indexOf(paradaId);
  if (idx === -1) return null;

  // buscamos el siguiente momento en que bus está ahí
  for (let t=minuto; t<minuto+2000; t++){
    if (paradaActual(bus, t) === paradaId)
      return t - minuto;
  }
  return null;
}
