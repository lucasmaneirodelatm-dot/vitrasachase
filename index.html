<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>VITRASA CHASE</title>
<style>
  :root{--accent:#004c99;--bg:#0f1720;--card:#0b1220;--muted:#99a3b2;--white:#fff}
  body{margin:0;font-family:Arial,Helvetica,sans-serif;background:linear-gradient(180deg,#071326,#0b1726);color:var(--white);display:flex;align-items:center;justify-content:center;height:100vh}
  #loader{position:fixed;inset:0;background:#fff;display:flex;align-items:center;justify-content:center;z-index:9999}
  #loader img{width:200px;height:auto}
  .app{display:none;width:980px;max-width:96%;padding:28px;border-radius:12px;background:rgba(0,0,0,0.25);box-shadow:0 10px 30px rgba(0,0,0,0.6)}
  header{display:flex;align-items:center;gap:18px}
  #logo{width:140px}
  h1{margin:0;font-size:26px;letter-spacing:1px}
  p.lead{color:var(--muted);margin:6px 0 20px}
  .modes{display:flex;gap:12px;flex-wrap:wrap}
  .mode{flex:1;min-width:220px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));padding:18px;border-radius:10px;text-align:left;cursor:pointer;border:1px solid rgba(255,255,255,0.03)}
  .mode h3{margin:0 0 6px}
  .mode p{margin:0;color:var(--muted)}
  .cta{display:inline-block;margin-top:12px;padding:10px 14px;border-radius:8px;background:var(--accent);color:#fff;text-decoration:none}
  #formArea{margin-top:18px}
  .hidden{display:none}
  label{display:block;margin:8px 0 6px;color:var(--muted);font-size:14px}
  input[type="text"], select{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:rgba(255,255,255,0.02);color:var(--white)}
  footer{margin-top:18px;color:var(--muted);font-size:13px}
</style>
</head>
<body>

<!-- Loader GIF (se debe ocultar cuando todos los recursos est√©n listos) -->
<div id="loader">
  <img src="https://raw.githubusercontent.com/lucasmaneirodelatm-dot/vitrasachase/refs/heads/main/LoaderAvanza.gif" alt="loader">
</div>

<div class="app" id="app">
  <header>
    <img id="logo" src="https://raw.githubusercontent.com/lucasmaneirodelatm-dot/vitrasachase/refs/heads/main/Logo-principal.png" alt="logo">
    <div>
      <h1>üöå VITRASA CHASE</h1>
      <p class="lead">Juego de persecuci√≥n multijugador por las calles de Vigo</p>
    </div>
  </header>

  <main>
    <section>
      <h2 style="margin-top:16px">üéÆ Selecciona c√≥mo quieres jugar</h2>
      <div class="modes">
        <div class="mode" id="mode-local" data-mode="local">
          <h3>üè† Juego Local</h3>
          <p>Dos jugadores en el mismo dispositivo. No se pregunta rol (se asignan al iniciar).</p>
          <a class="cta" href="#" onclick="selectMode('local');return false;">Elegir Juego Local</a>
        </div>

        <div class="mode" id="mode-ia" data-mode="ia">
          <h3>ü§ñ Contra IA</h3>
          <p>El jugador elige rol; la IA toma el otro.</p>
          <a class="cta" href="#" onclick="selectMode('ia');return false;">Jugar contra IA</a>
        </div>

        <div class="mode" id="mode-online" data-mode="online">
          <h3>üåê Juego Online</h3>
          <p>Crear sala y enviar enlace. (Online: pendiente de servidor)</p>
          <a class="cta" href="#" onclick="selectMode('online');return false;">Crear sala (Online)</a>
        </div>
      </div>

      <div id="formArea" class="hidden">
        <form id="mainForm" onsubmit="return onSubmitForm(event)">
          <div id="formFields"></div>
          <div style="margin-top:12px; text-align:right;">
            <button type="submit" class="cta">Crear / Empezar</button>
            <a href="#" style="margin-left:8px;color:var(--muted);text-decoration:none" onclick="resetToMenu();return false;">Volver</a>
          </div>
        </form>
      </div>
    </section>
  </main>

  <footer>Versi√≥n inicial ¬∑ Local / IA funcionan sin servidor. Online requiere backend (m√°s tarde).</footer>
</div>

<script>
/* ---------- Configuraci√≥n de rutas de datos (reemplazar con raw.github si lo subes) ---------- */
const DATA_PATHS = {
  paradas: '/mnt/data/paradas.json',
  lineas: '/mnt/data/lineas.json',
  buses:  '/mnt/data/buses.json'
};
/* ------------------------------------------------------------------------------------------- */

/* Simulaci√≥n de "recursos listos" -> oculta loader solo cuando fetch de paradas/lineas/buses responde.
   Si tu deploy usa rutas diferentes cambia DATA_PATHS arriba. */
async function waitResources() {
  try {
    const urls = Object.values(DATA_PATHS);
    const checks = urls.map(u => fetch(u, {method:'GET'}));
    await Promise.all(checks);
  } catch(e){
    // si fallan los fetch (p. ej. en local a√∫n no existe), no bloqueamos: ocultamos loader pero indicamos aviso.
    console.warn('No pude comprobar recursos; contin√∫a igualmente (cambia rutas DATA_PATHS si es necesario).', e);
  } finally {
    document.getElementById('loader').style.display = 'none';
    document.getElementById('app').style.display = 'block';
  }
}
waitResources();

/* UI handlers */
let selectedMode = null;
function selectMode(mode) {
  selectedMode = mode;
  document.getElementById('formArea').classList.remove('hidden');
  const fields = document.getElementById('formFields');
  fields.innerHTML = '';
  if (mode === 'local') {
    fields.innerHTML = `
      <label>Jugador 1 ‚Äî Nombre</label>
      <input required name="j1" id="j1" type="text" placeholder="Jugador 1">
      <label>Jugador 2 ‚Äî Nombre</label>
      <input required name="j2" id="j2" type="text" placeholder="Jugador 2">
      <p style="color:var(--muted);font-size:13px;margin-top:8px">En local no se pregunta rol; ambos se colocan al inicio donde quieran.</p>
    `;
  } else if (mode === 'ia') {
    fields.innerHTML = `
      <label>Tu nombre</label><input required name="j1" id="j1" type="text" placeholder="Tu nombre">
      <label>Elige tu rol</label>
      <select name="role" id="role">
        <option value="fugitivo">Fugitivo</option>
        <option value="perseguidor">Perseguidor</option>
      </select>
      <label>Nivel IA</label>
      <select name="iaLevel" id="iaLevel">
        <option value="easy">F√°cil</option>
        <option value="normal" selected>Normal</option>
        <option value="hard">Dif√≠cil</option>
      </select>
    `;
  } else if (mode === 'online') {
    fields.innerHTML = `
      <label>Tu nombre</label><input required name="j1" id="j1" type="text" placeholder="Tu nombre">
      <label>Elegir rol (creador)</label>
      <select name="role" id="role">
        <option value="fugitivo">Fugitivo</option>
        <option value="perseguidor">Perseguidor</option>
      </select>
      <p style="color:var(--muted);font-size:13px;margin-top:8px">Se generar√° un enlace de sala para compartir (requiere servidor).</p>
    `;
  }
}

function onSubmitForm(e){
  e.preventDefault();
  const data = Object.fromEntries(new FormData(e.target).entries());
  // redirecci√≥n simple seg√∫n modo (usa querystring para pasar datos)
  const q = new URLSearchParams({mode:selectedMode,...data}).toString();
  if (selectedMode==='local' || selectedMode==='ia') {
    // abrir juego local (bus.html) con params
    window.location.href = `bus.html?${q}`;
  } else {
    // online: crear sala (por ahora redirige a bus.html, en futuro usar socket)
    window.location.href = `bus.html?${q}&online=1`;
  }
}

function resetToMenu(){
  document.getElementById('formArea').classList.add('hidden');
  selectedMode = null;
}
</script>

</body>
</html>
