<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Parada</title>
<link rel="stylesheet" href="../styles.css">
</head>
<body>

<h2>ğŸš Parada actual</h2>

<div id="notifs"></div>
<div id="buses"></div>

<script>
window.addEventListener("message", ev => {
    if(ev.data.type === "worldUpdate"){
        const { buses, notificaciones } = ev.data.data;

        document.getElementById("notifs").innerHTML =
            notificaciones.map(n => `<div class='notif'>ğŸ”” ${n.texto}</div>`).join("");

        document.getElementById("buses").innerHTML = 
            Object.values(buses).map(b =>
                `<div class='busCard'>
                    ğŸšŒ ${b.linea} â€” ETA: ${b.eta}s
                    <button class='btn' onclick="parent.postMessage({ type:'cogerBus', bus:'${b.id}' }, '*')">COGER</button>
                </div>`).join("");
    }
});
</script>

</body>
</html>
