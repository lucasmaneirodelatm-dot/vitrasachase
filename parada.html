<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Parada</title>
<link rel="stylesheet" href="styles.css">
</head>
<body>

<h2>ğŸš Parada actual</h2>

<div id="busList"></div>

<button id="walk" class="btn">ğŸš¶ Caminar a otra parada</button>

<script>
window.addEventListener("message", ev => {
    if (ev.data.type === "world_update") {
        const buses = ev.data.buses;
        const list = document.getElementById("busList");
        list.innerHTML = "";

        Object.values(buses).forEach(b => {
            if (b.current === "6940") {
                list.innerHTML += `<div>ğŸšŒ ${b.linea} â€” ahora <button onclick="parent.postMessage({type:'coger',bus:'${b.id}'},'*')" class="btn">COGER</button></div>`;
            } else {
                list.innerHTML += `<div>ğŸšŒ ${b.linea} â€” ${b.eta} s</div>`;
            }
        });
    }
});
</script>

</body>
</html>
