<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Parada </title>
<link rel="stylesheet" href="styles.css">
<script src="datos.js"></script>
</head>
<body>

<h1>üöè Parada</h1>

<div id="info"></div>
<div id="buses"></div>

<script>
const p = new URLSearchParams(window.location.search);
const paradaId = p.get("id") || "6620";

// Reloj interno
setInterval(() => {
  reloj++;
  actualizar();
}, 1000);

function actualizar(){
  document.getElementById("info").innerHTML =
    `<h2>Parada ${paradaId}</h2><p>Hora virtual: ${reloj}</p>`;

  let html = "";

  for (const id in BUSES){
    const bus = BUSES[id];
    const t = eta(bus, paradaId, reloj);

    if (t === null) continue;

    html += `
      <div class="busCard">
        üöå L√≠nea ${bus.linea}
        <br>‚è≥ Llega en: ${t} min
        ${t === 0 ? 
          `<button class='btn' onclick='coger("${id}")'>COGER</button>` :
          `<small>Esperando...</small>`
        }
      </div>
    `;
  }

  document.getElementById("buses").innerHTML = html;
}

function coger(busId){
  location.href = "bus.html?id=" + busId;
}

actualizar();
</script>
</body>
</html>
